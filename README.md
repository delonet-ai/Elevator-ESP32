**Elevator ESP32 ‚Äî  –º–∏–Ω–∏-–ª–∏—Ñ—Ç ESP32**
–° –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–º –ø—É–ª—å—Ç–æ–º, OLED-–∞–Ω–∏–º–∞—Ü–∏–µ–π, –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π –∏ –ø–ª–∞–≤–Ω—ã–º –¥–≤–∏–∂–µ–Ω–∏–µ–º

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –æ–±—É—á–∞—é—â–∏–π –º–∏–Ω–∏-–ª–∏—Ñ—Ç (–¥–ª—è –∏–≥—Ä—É—à–µ–∫), –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –±–∞–∑–µ –¥–≤—É—Ö ESP32:
Base ESP32 ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç –º–æ—Ç–æ—Ä–æ–º, –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π, –¥–≤–∏–∂–µ–Ω–∏–µ–º, –ª–æ–≥–∏–∫–æ–π –∏ –¥–∞—Ç—á–∏–∫–∞–º–∏.
Remote ESP32 ‚Äî –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–π –ø—É–ª—å—Ç —Å OLED-—ç–∫—Ä–∞–Ω–æ–º, –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –∫–Ω–æ–ø–æ–∫ –∏ ESP-NOW —Å–≤—è–∑—å—é.

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π, —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ Wi-Fi, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –∏ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é state-machine –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

**‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**
üéõ 3 —ç—Ç–∞–∂–∞
–õ–∏—Ñ—Ç —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–∂, —É–º–µ–µ—Ç –µ–∑–¥–∏—Ç—å –∫ –ª—é–±–æ–º—É, —Ç–æ—Ä–º–æ–∑–∏—Ç –ø–µ—Ä–µ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π.
üõ∞ –ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–π –ø—É–ª—å—Ç (ESP-NOW)

**üìü OLED-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π**
–ü—É–ª—å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
—Ç–µ–∫—É—â–∏–π —ç—Ç–∞–∂ (–∫—Ä—É–ø–Ω—ã–π, –≤ —Ü–µ–Ω—Ç—Ä–µ —ç–∫—Ä–∞–Ω–∞)
–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è (–∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–µ–ª–∫–∞ –∫–∞–∫ –≤ –Ω–∞—Å—Ç–æ—è—â–∏—Ö –ª–∏—Ñ—Ç–∞—Ö)
—Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å —Å–ª–µ–≤–∞
–æ—à–∏–±–∫–∏ / –∫–∞–ª–∏–±—Ä–æ–≤–∫—É

**üî¶ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫**
Up/Down ‚Äî –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω—ã
–ö–Ω–æ–ø–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —ç—Ç–∞–∂–∞ ‚Äî –º–∏–≥–∞–µ—Ç
–ö–Ω–æ–ø–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç—Ç–∞–∂–∞ ‚Äî –≥–æ—Ä–∏—Ç
–í –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ ‚Äî –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–Ω–æ–ø–∫–∏

**üß≠ –ü–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ**
–ú–æ—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å:
–ø–ª–∞–≤–Ω—ã–º —Ä–∞–∑–≥–æ–Ω–æ–º
–∫—Ä–µ–π—Å–µ—Ä—Å–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é
—Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ–º –ø–µ—Ä–µ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π
–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ —Ö–æ–¥—É

**üéö –†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏**
–ü–æ—Ç–µ–Ω—Ü–∏–æ–º–µ—Ç—Ä –∑–∞–¥–∞—ë—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è.

**üß∞ –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏**
–ù–∞ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∏–ª–∏ –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞:
–ù–∞–∂–∏–º–∞–µ–º UP ‚Üí –ª–∏—Ñ—Ç –µ–¥–µ—Ç –≤–≤–µ—Ä—Ö –¥–æ –∫–æ–Ω—Ü–µ–≤–∏–∫–∞ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–µ—Ä—Ö–Ω—é—é –ø–æ–∑–∏—Ü–∏—é.
–ù–∞–∂–∏–º–∞–µ–º DOWN ‚Üí –ª–∏—Ñ—Ç –µ–¥–µ—Ç –≤–Ω–∏–∑.
–ù–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É 1 —ç—Ç–∞–∂–∞ ‚Üí —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∏–∂–Ω—è—è —Ç–æ—á–∫–∞.
–õ–∏—Ñ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—á–∏—Ç–∞–µ—Ç –¥–ª–∏–Ω—É —Ç—Ä–æ—Å–∞ –∏ –¥–µ–ª–∏—Ç –µ—ë –Ω–∞ 3 —ç—Ç–∞–∂–∞.

**üîÅ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞**
–ù–∞ –±–∞–∑–µ –µ—Å—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∫–Ω–æ–ø–∫–∞ –Ω–∞ GPIO 33:
—É–¥–µ—Ä–∂–∞–Ω–∏–µ 3 —Å–µ–∫—É–Ω–¥—ã ‚Üí –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
–ª–∏—Ñ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º –ø–µ—Ä–≤–∏—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚ö° –ë—ã—Å—Ç—Ä–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–Ω–∏–∑
–í–æ –≤—Ä–µ–º—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–ø—É—Å–∫–∞–Ω–∏—è –Ω–∏–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ (–º–Ω–æ–∂–∏—Ç–µ–ª—å).

**üõ† –†–µ–∂–∏–º —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**
–ö–Ω–æ–ø–∫–∏ UP/DOWN –Ω–∞ –ø—É–ª—å—Ç–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –ª–∏—Ñ—Ç.

**üîß –ñ–µ–ª–µ–∑–æ (BOM)**
**üß† –ë–∞–∑–∞ (–ª–∏—Ñ—Ç)**
ESP32 DevKit	–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ª–∏—Ñ—Ç–∞
–®–∞–≥–æ–≤—ã–π –º–æ—Ç–æ—Ä NEMA + –¥—Ä–∞–π–≤–µ—Ä (A4988 / DRV8825 / TMC2208)	–¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞–±–∏–Ω—ã
–ö–æ–Ω—Ü–µ–≤–∏–∫ –≤–µ—Ä—Ö–Ω–∏–π	–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä—Ö–Ω–µ–≥–æ —ç—Ç–∞–∂–∞
–ü–æ—Ç–µ–Ω—Ü–∏–æ–º–µ—Ç—Ä	—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
–ö–Ω–æ–ø–∫–∞ –Ω–∞ GPIO33	–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
–ü–∏—Ç–∞–Ω–∏–µ 3S Li-ion + BMS	—Å–∏–ª–æ–≤–∞—è —á–∞—Å—Ç—å
DC-DC 12‚Üí5	–ø–∏—Ç–∞–Ω–∏–µ ESP32

**–ü–∏–Ω—ã –±–∞–∑—ã**
STEP	18
DIR	19
ENABLE	21
–í–µ—Ä—Ö–Ω–∏–π –∫–æ–Ω—Ü–µ–≤–∏–∫	A1
–ü–æ—Ç–µ–Ω—Ü–∏–æ–º–µ—Ç—Ä	A2
–ö–Ω–æ–ø–∫–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏	33

**üéÆ –ü—É–ª—å—Ç (remote ESP32)**
ESP32 DevKit	–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è + UI
OLED SSD1306 128√ó32	–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
5 –∫–Ω–æ–ø–æ–∫	—ç—Ç–∞–∂–∏ + –≤–≤–µ—Ä—Ö + –≤–Ω–∏–∑
5 —Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤	–∏–Ω–¥–∏–∫–∞—Ü–∏—è
–ü–∏—Ç–∞–Ω–∏–µ 1S Li-ion	–∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å
TP4056/BMS	–∑–∞—Ä—è–¥–∫–∞ –∏ –∑–∞—â–∏—Ç–∞
  –ü–∏–Ω—ã –ø—É–ª—å—Ç–∞
Down	13
Up	14
Floor 1	27
Floor 2	26
Floor 3	25
  –°–≤–µ—Ç–æ–¥–∏–æ–¥—ã
LED Down	19
LED Up	18
LED F1	5
LED F2	4
LED F3	33
  OLED
SDA	21
SCL	22

üì° –ü—Ä–æ—Ç–æ–∫–æ–ª ESP-NOW
–ö–æ–º–∞–Ω–¥—ã –ø—É–ª—å—Ç–∞ ‚Üí –±–∞–∑–∞
CMD_CALL_FLOOR
CMD_STOP
CMD_CALIB
CMD_CALIB_DOWN_START
CMD_CALIB_DOWN_SAVE
CMD_MANUAL_UP
CMD_MANUAL_DOWN
CMD_MANUAL_STOP

–°—Ç–∞—Ç—É—Å –±–∞–∑–∞ ‚Üí –ø—É–ª—å—Ç
state (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞)
currentFloor
targetFloor
direction
speedPercent
error
needCalib
uptime

–°—Ç–∞—Ç—É—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 200 –º—Å.

**üîÅ State Machine (–±–∞–∑–∞)**
–û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
STATE_BOOT
STATE_NEED_CALIB
STATE_CALIB_HOMING_UP
STATE_CALIB_MOVING_DOWN
STATE_IDLE
STATE_MOVING
STATE_MANUAL_MOVE
STATE_ERROR
–¢–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∞ –∫–∞–∂–¥—ã–µ 20 –º—Å.

**üßÆ –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞**
–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
–õ–∏—Ñ—Ç —Å—Ç–æ–∏—Ç –≤ STATE_NEED_CALIB
–ù–∞–∂–∏–º–∞–µ–º UP ‚Üí –≤—ã–µ–∑–¥ –≤–≤–µ—Ä—Ö (STATE_CALIB_HOMING_UP)
–ö–æ–Ω—Ü–µ–≤–∏–∫ ‚Üí —Ñ–∏–∫—Å–∏—Ä—É–µ–º –≤–µ—Ä—Ö
–ù–∞–∂–∏–º–∞–µ–º DOWN ‚Üí —Å–ø—É—Å–∫ –≤–Ω–∏–∑ (STATE_CALIB_MOVING_DOWN)
–ù–∞–∂–∏–º–∞–µ–º Floor 1 ‚Üí —Ñ–∏–∫—Å–∏—Ä—É–µ–º –Ω–∏–∑
–õ–∏—Ñ—Ç –≥–æ—Ç–æ–≤ (STATE_IDLE)

–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
GPIO33 (—É–¥–µ—Ä–∂–∞–Ω–∏–µ ‚â•3s) ‚Üí –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å EEPROM.
üñ• OLED-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—É–ª—å—Ç–∞

**–≠–∫—Ä–∞–Ω —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —Ç—Ä–∏ –∑–æ–Ω—ã:**

+----------------+------------------+-----------------+
|   –°—Ç–∞—Ç—É—Å       |  –ö—Ä—É–ø–Ω—ã–π —ç—Ç–∞–∂    |  –ê–Ω–∏–º–∞—Ü–∏—è       |
|   (—Ç–µ–∫—Å—Ç)      |      (size=3)    |  —Å—Ç—Ä–µ–ª–∫–∏ ‚Üë‚Üì‚Üî    |
+----------------+------------------+-----------------+

–ê–Ω–∏–º–∞—Ü–∏—è —Å—Ç—Ä–µ–ª–∫–∏
–í–≤–µ—Ä—Ö ‚Üí –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–µ–ª–∫–∏ ‚Äú–±–µ–≥—É—Ç —Å–µ–≥–º–µ–Ω—Ç—ã‚Äù –≤–≤–µ—Ä—Ö
–í–Ω–∏–∑ ‚Üí —Å–µ–≥–º–µ–Ω—Ç—ã –±–µ–≥—É—Ç –≤–Ω–∏–∑
–°—Ç–æ–∏–º ‚Üí —Ç–æ–ª—Å—Ç–∞—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ millis() –∫–∞–∂–¥—ã–µ ~150 –º—Å.

**‚öô –ú–æ—Ç–æ—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä**
–ü–ª–∞–≤–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∏ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ
–†–∞—Å—Å—á—ë—Ç —Ç–æ—Ä–º–æ–∑–Ω–æ–≥–æ –ø—É—Ç–∏ (v¬≤ / (2a))
–†–µ–∂–∏–º MoveTo —Å –∞–≤—Ç–æ—Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ–º

–†–µ–∂–∏–º Manual
–û—Ç–¥–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –≤–Ω–∏–∑:
if (calibDownFastFlag && manualDir < 0) {
    baseSpeed *= X;   // –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–∫–æ—Ä–æ—Å—Ç–∏
}

**üß™ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞**

‚úî M–æ—Ç–æ—Ä –¥–≤–∏–≥–∞–µ—Ç –∫–∞–±–∏–Ω—É –ø–ª–∞–≤–Ω–æ
‚úî –ü—É–ª—å—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úî ESP-NOW —Å—Ç–∞–±–∏–ª—å–Ω—ã–π
‚úî –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω–∞–¥—ë–∂–Ω–∞—è
‚úî OLED-UI –∫—Ä–∞—Å–∏–≤—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π —Ä–µ–±—ë–Ω–∫—É
‚úî –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
‚úî –ë—ã—Å—Ç—Ä–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–Ω–∏–∑ —Ä–∞–±–æ—Ç–∞–µ—Ç

